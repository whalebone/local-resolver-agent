version: '3'
services:
  lr-agent:
    image: whalebone/agent:1.3
    name: lr-agent
    stdin_open: true
    tty: true
    pid_mode: "host"
    privileged: true
    dns:
      - localhost
    network_mode: host
    logging:
        driver: json-file
        options:
          max-size: "10m"
          max-file: "1"
    labels:
        lr-agent: "2.0"
    environment:
      CLIENT_CRT_BASE64: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZPRENDQXlDZ0F3SUJBZ0lDRUFFd0RRWUpLb1pJaHZjTkFRRUxCUUF3Z1lVeEN6QUpCZ05WQkFZVEFrTmEKTVJjd0ZRWURWUVFJREE1RGVtVmphQ0JTWlhCMVlteHBZekVaTUJjR0ExVUVDZ3dRVjJoaGJHVmliMjVsSUhNdQpjaTV2TGpFZ01CNEdBMVVFQ3d3WFZHVnpkR2x1WnlCcGJuUmxjbTFsWkdsaGRHVWdRMEV4SURBZUJnTlZCQU1NCkYxUmxjM1JwYm1jZ2FXNTBaWEp0WldScFlYUmxJRU5CTUI0WERURTRNREl3TnpFNU5ESXpNbG9YRFRJNE1ESXcKTlRFNU5ESXpNbG93Y0RFTE1Ba0dBMVVFQmhNQ1Exb3hGekFWQmdOVkJBZ01Ea042WldOb0lGSmxjSFZpYkdsagpNUmt3RndZRFZRUUtEQkJYYUdGc1pXSnZibVVnY3k1eUxtOHVNUjh3SFFZRFZRUUxEQlpNYjJOaGJDQnlaWE52CmJIWmxjaUJoWjJWdWRDQXhNUXd3Q2dZRFZRUUREQU14TURFd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFEQ0FTRlZ4YjNUbzNIZk1ScjM1a2NueVpoc3BzTUhacXZMZ0ZpSXVSc3hjQUhRR2MragpoWGF5UzU4ZGhzQWw0by9Hdk5yaWUreVZVQ0cyeDF2eHlTSWp3dWE3c2w0TW1haFJJcUYwUFNhMVo4ZjlLSWtzClNKZk0wRHloUThVT0V2bGR2T1dEMitHTzlBZTVBbXVzT3JsNk9QUTNZR0FDdUN5akhINUdkR29kUStkOHEvZVcKMk9XeThjS2g2MnNZUlErc0lFa0hQb0Y4NXJadjFlV0YzYmlwdStRbHM3QVJod3JtalVxZnF0MDlsZm9qaW01RApBN0dEaXVjRTVnYTVFZ1ZYTjROTFZtbk1HSHFJL2xrSjRhR2NQTEQvSDdTSWI1THV3S3h5MWhBUUc1MXFudStjCnZ5RktKK1k5c1hxOC9zWDRDMDNvZWdYdHgwbkh1YzZmdXR2eEFnTUJBQUdqZ2NVd2djSXdDUVlEVlIwVEJBSXcKQURBUkJnbGdoa2dCaHZoQ0FRRUVCQU1DQmFBd013WUpZSVpJQVliNFFnRU5CQ1lXSkU5d1pXNVRVMHdnUjJWdQpaWEpoZEdWa0lFTnNhV1Z1ZENCRFpYSjBhV1pwWTJGMFpUQWRCZ05WSFE0RUZnUVVFRG5nbEJ6b2MxZUFZV2I1CnRNTjNzeUx4b09Zd0h3WURWUjBqQkJnd0ZvQVVmQWdoWkJzaWx1ekgwR2Uycms3T2Y0OVJBQkF3RGdZRFZSMFAKQVFIL0JBUURBZ1hnTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQ0JnZ3JCZ0VGQlFjREJEQU5CZ2txaGtpRwo5dzBCQVFzRkFBT0NBZ0VBT0hxYnpUdnk4Qjh3NmY0YU9NZEtSbm9MZW5xTWhoZ21iRkJaTVBkelNNbW5yK0ZJCkg3SklHNjgzT09YNmE5SDZZb0lGT3RWTnhlYXc3SGpXYmh3OVJyYVZKUVRvdUMyWlBZYStYYjVwZG9FalFrSGYKY3FEbWNKTUJrYU1rN21pOForMVVscUJYYzhNR1d3SjhGVG93RE82MFVXNm9sMjN4VzBmWWNNZGpXZW9PbDltWgppSjZYMVRyWEEzd0wydnk3ZTJpNHRldm03dlp6d2FXYjlxNEFjbXo4NDV2MGhtY29sTWw3YU9PQk5MRkdjYzQzCkpsZE9qZllLNXlZVFVJVzdKTzNNTHI1d0NHdlk4d3dVOHh0MXN4amJUMHIzR1dFYnl3RkVac1p3b0xneTZ2N3oKalBSbjRjK1RCMmxKQWlNRU95NTMzL0dzMUJSR1lLSHE4VlNnNXg2Vi9kZGIwU2hMTDQ0YkJlTHIvVUlCb015bQpzSGxmNlhJYkdxZEJQRGVCL3ZjYWxDbXNVcGh4OWNFYUtSOUVoQ1pvL1BTOWNGUi9XUEUrbjJUdDdjdDlFN3RUCm9oMkJtTzhnTHI0RWF1TjRVbk4yR3RvYTQ0NS82WG9WMkpOTDZRYjlZQjc2NGtQOTNzYVdaQTBCKzRUWmpGdncKcTVudzZySzc5eWdXT2dPSnllZlEwSVp6VS90N1JJYUJ0N3VRS0tpQWVCeTVNU3lYMUNHM25xU0loV3dQRFhuYgpyWHVYUVJRSFgrS2RvaHYxc0ZSR3RmYVdiWVExeXJNOEw3UXV1SkVsb05maVgrenZKVkswWXJrR3JSUm9tRDVLCnl5S3Y4U3hlZTF2b1JoRGh2WmFOclAyQktXWkdmb21sSGhmeHdhaFlKMVBubDRmWElHSUsrc2FRblpFPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
      CLIENT_KEY_BASE64: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBd2dFaFZjVzkwNk54M3pFYTkrWkhKOG1ZYktiREIyYXJ5NEJZaUxrYk1YQUIwQm5QCm80VjJza3VmSFliQUplS1B4cnphNG52c2xWQWh0c2RiOGNraUk4TG11N0plREptb1VTS2hkRDBtdFdmSC9TaUoKTEVpWHpOQThvVVBGRGhMNVhiemxnOXZoanZRSHVRSnJyRHE1ZWpqME4yQmdBcmdzb3h4K1JuUnFIVVBuZkt2MwpsdGpsc3ZIQ29ldHJHRVVQckNCSkJ6NkJmT2EyYjlYbGhkMjRxYnZrSmJPd0VZY0s1bzFLbjZyZFBaWDZJNHB1ClF3T3hnNHJuQk9ZR3VSSUZWemVEUzFacHpCaDZpUDVaQ2VHaG5EeXcveCswaUcrUzdzQ3NjdFlRRUJ1ZGFwN3YKbkw4aFNpZm1QYkY2dlA3RitBdE42SG9GN2NkSng3bk9uN3JiOFFJREFRQUJBb0lCQVFDQitZWGUxQnNvWmxGTgpDYllhclpHd2ExU09QbTlkVHdENzF1SDV2NklqVGZvNDlJSHkrT0NiOVNRR0FSaE1pV3h2NW1qeTRibVFFMTV5CitUOTFUcDVydlJFZVlSSzNlRjZXOVErY003ZnlRelJ1UERFaWxRUDJlUENWempTQUNHQSsxK1lnb0RpT3NKbFgKN3ZJNk1pRy9hOWJhSHR4VUZoWDV0WVk0SjVoTVA5NVJjTzJwUEVvNk5Ja0ZFVXJUdUorUmFKQ2ZNa3Nwbit0KwpDWTZsR29YQlkwSnRLYVUxUW1IRHdjcjJ0TDRCTFBrelIvdTUrLzNtREdqVGQzR3dZNWlFKzFpb3lKbHFHRVdBCkRNMTZhUVB5bXR0blZQOW1jYVJyU2IyNXJtdTR2dXlqazN4aTdvaDYvWi9jSUw0cmttbGdrNnJ5YW1jcDA1TTEKRzZ1QjBpTEJBb0dCQU9jQ0tPVXUvM0ZFT3pIb1FmVWNmSGNFeGFFalBoRDdUVmdGd2Z1VjdadDRyY2JXY0twMwp5STQvNk1FS3dHQlJoSEIyRnl2T1JrWWtGVVhkeWlFUTBnRG9EZUt4UkMxY1J3Sm1aSFMxZ2NkRVR0K2JnQ1F4CkVIOFJaNEZZTGp5aE54VTZseXdic3A5NDZpZ3VpUGJua3VsZTNJTHlhSEpJYmZBbmpZZDVaa1haQW9HQkFOYisKSWx4WFltWW1rdDBrWkxQTWFIa1FXVjM2akh4eWxjYksxYkZJd2thQjBiZWxmcHVEMjlmblE4bWplSHJleXVZbgpXUGhFMDVOMmxOdkJnc2FFZVBEcWlYRXYrbFJ4V1FCeDFnQllDM1hIK0JkYXAxVGxqMGQ0aWJhTXczZEs4Q05tCkNaNDFzaVM5NzQ1ajlDQkxIOHFaZzgzcXNuZFdZMVRzSERTWm0zL1pBb0dBVkdHcWxJVEZWQmRyVkFDVnp6WDMKbFBZT1Jwejc5L0lEdjRwaTRFWlV3N3lpSllhQkl4T2NFN0h1a0UwZ0ZrN1FoTS91Q05kUlBoL0NFWUpCYWpDZAp0UzBPbldiSkU1U29iNHo5VnRCU05ucVNJUVhKR2U4K0tsd3VKY1lUSlp4eDVYUkFjaUV2N3lhWXlkS3R2eHE1CnhEc2RhMHVtc1ZBWnNHYVNRUkVzTllrQ2dZQXlXODdDb0hsZEFoWU9sTEs5NXRobDJ5MkR0T2RwVXhIQVFjeXkKUFIrOGtqWUVkVkJscndvMDFXZnNlRTBGUXVCMTdxdUpZOTNIUWRSMmNTcG53Nm5zakpOckh0amRKTHU3UGU3cApuN1gzZmNLZi9jMEtOc2RMNzNFYWdIaGNuZ0lIMktQU0dqUERKWFpTZlJrMjQwSHNHKzlpc1dIaVVDcnVQbXdRCjZoWWhhUUtCZ1FDWjRuaGloaHBCMXArcXV2d3Uwcy9qOHE0TVZiemtHNW5wNG45b1p4UGtJM1EzMmk0TzFCSDgKeTREYmlxazJQaEcxSkFzcTZqWnhaQzFzSGRCWXZzVWNoQ3VBcE0rc3pPaEhNenZEa0p2dTNLcGdNekQ1NzZVTgpUWFpvbU5kRGs3eHExSXBrSVpqTlZ1UTJMRTQ0MVVLclBXOXZoblNMTitRcHRZckIza2J1NkE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
      LOGGING_LEVEL: "so much"
      PROXY_ADDRESS: "wss://localhost:8443/wsproxy/ws"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/log/whalebone/:/etc/whalebone/log/
      - /etc/whalebone/kres/:/etc/whalebone/resolver/
      - /var/log/whalebone/agent/:/etc/whalebone/logs/
      - /var/sinkhole/:/etc/whalebone/kresman
      - /etc/os-release:/etc/os-release:ro